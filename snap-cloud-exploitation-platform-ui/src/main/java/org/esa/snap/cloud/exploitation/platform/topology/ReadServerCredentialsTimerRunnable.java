package org.esa.snap.cloud.exploitation.platform.topology;

import org.esa.snap.cloud.exploitation.platform.loading.AbstractTimerRunnable;
import org.esa.snap.cloud.exploitation.platform.loading.ILoadingIndicator;
import org.esa.snap.cloud.exploitation.platform.loading.IMessageDialog;

/**
 * Created by jcoravu on 19/12/2018.
 */
public class ReadServerCredentialsTimerRunnable extends AbstractTimerRunnable<RemoteTopology> {

    private final IMessageDialog parentWindow;

    public ReadServerCredentialsTimerRunnable(IMessageDialog parentWindow, ILoadingIndicator loadingIndicator, int threadId) {
        super(loadingIndicator, threadId, 500);

        this.parentWindow = parentWindow;
    }

    @Override
    protected final void onTimerWakeUp(String messageToDisplay) {
        super.onTimerWakeUp("Loading...");
    }

    @Override
    protected RemoteTopology execute() throws Exception {
        return RemoteTopologyUtils.readTopology();
    }

    @Override
    protected String getExceptionLoggingMessage() {
        return "Failed to read the remote topology from the file.";
    }

    @Override
    protected final void onFailed(Exception exception) {
        this.parentWindow.showErrorDialog("Failed to read the remote topology from the file.", "Failed");
    }
}
