package org.esa.snap.cloud.exploitation.platform.operator;

import org.esa.snap.cloud.exploitation.platform.CloudExploitationPlatformOp;
import org.esa.snap.cloud.exploitation.platform.loading.AbstractTimerRunnable;
import org.esa.snap.cloud.exploitation.platform.loading.ILoadingIndicator;

public class UnmountLinuxLocalFolderTimerRunnable extends AbstractTimerRunnable<Void> {

    private final String localSharedFolderPath;
    private final String localPassword;
    private final boolean localSharedFolderCreated;

    public UnmountLinuxLocalFolderTimerRunnable(ILoadingIndicator loadingIndicator, int threadId, String localSharedFolderPath,
                                                String localPassword, boolean localSharedFolderCreated) {

        super(loadingIndicator, threadId, 500);

        this.localSharedFolderPath = localSharedFolderPath;
        this.localPassword = localPassword;
        this.localSharedFolderCreated = localSharedFolderCreated;
    }

    @Override
    protected final void onTimerWakeUp(String messageToDisplay) {
        super.onTimerWakeUp("Unmounting local shared folder...");
    }

    @Override
    protected String getExceptionLoggingMessage() {
        return "Failed to unmount the local shared folder '"+this.localSharedFolderPath+"'.";
    }

    @Override
    protected Void execute() throws Exception {
        CloudExploitationPlatformOp.unmountLinuxLocalFolder(this.localSharedFolderPath, this.localPassword, this.localSharedFolderCreated);
        return null;
    }
}
